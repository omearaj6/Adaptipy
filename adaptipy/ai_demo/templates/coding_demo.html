<!DOCTYPE html>
<html>
<head>
    <title>Python Coding Demo</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .btn { color: white; padding: 10px 20px; text-decoration: none; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        .new-problem-btn { background: #28a745; }
        .run-code-btn { background: #007bff; }
        .topic-selector { background: #6c757d; }
        textarea { width: 100%; margin: 10px 0; font-family: monospace; }
        .result { margin-top: 20px; padding: 15px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .feedback { background: #e7f3ff; color: #004085; border: 1px solid #b8daff; margin-top: 15px; }
        .topic-section { margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; }
        .button-group { display: flex; gap: 10px; flex-wrap: wrap; margin: 10px 0; }
        select { padding: 8px; border-radius: 4px; border: 1px solid #ccc; }
        .hint-icon { font-weight: bold; margin-right: 5px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Python Coding Practice</h1>
        <form method="POST" style="display: inline;">
            {% csrf_token %}
            <button type="submit" name="new_problem" class="btn new-problem-btn">
                New Problem
            </button>
        </form>
    </div>
    
    <!-- Topic Selection Section -->
    <div class="topic-section">
        <h3>Select Topic to Practice</h3>
        <form method="POST">
            {% csrf_token %}
            <select name="topic">
                {% for topic in topics %}
                    <option value="{{ topic }}" {% if topic == selected_topic %}selected{% endif %}>
                        {{ topic|title }}
                    </option>
                {% endfor %}
            </select>
            <button type="submit" name="select_topic" class="btn topic-selector">
                Select Topic
            </button>
        </form>
        <p><small>Current topic: <strong>{{ selected_topic|title }}</strong></small></p>
    </div>
    
    <!-- Problem Section -->
    <div class="problem-section">
        <p><strong>AI-Generated Problem:</strong></p>
        <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
            {{ ai_problem }}
        </div>
    </div>
    
    <!-- Code Input Section -->
    <form method="POST">
        {% csrf_token %}
        <textarea name="code" rows="10" placeholder="Write your Python code here...">{{ user_code }}</textarea>
        
        <div class="button-group">
            <button type="submit" class="btn run-code-btn">Run Code</button>
        </div>
    </form>
    
    <!-- Results Section -->
    {% if result %}
    <div class="result {% if 'Correct!' in result %}success{% else %}error{% endif %}">
        <strong>Result:</strong> {{ result }}
    </div>
    {% endif %}
    
    <!-- AI Feedback Section -->
    {% if evaluation_feedback %}
    <div class="result feedback">
        <strong>Hint:</strong> {{ evaluation_feedback }}
    </div>
    {% endif %}
</body>
</html>